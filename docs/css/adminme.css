/* =====================================================================
   me.css — Admin edition (drop-in replacement)
   - No inline styles. Safe defaults for all sections adminme.js uses.
   - 2025-09-28
===================================================================== */

/* ========== 0) Reset & tokens ========== */
* { box-sizing: border-box; margin: 0; padding: 0; }
:root{
  --bg: #F5F6F8;
  --panel: #FFFFFF;
  --line: rgba(0,0,0,.08);
  --shadow: 0 6px 20px rgba(0,0,0,.06);
  --text: #111;
  --muted: #68707D;
  --accent: #FFA765;
  --focus: #0B72FF;

  --container-w: clamp(360px, 88vw, 1100px);
  --nav-h: 64px;

  /* avatar hue bucket (set via class) */
  --h: 210;

  /* spacing */
  --gap: 16px;
  --radius: 16px;
}

html, body { height: 100%; }
body{
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color: var(--text);
  background: var(--bg);
  -webkit-font-smoothing: antialiased;
}

:where(a,button,[role="button"],input,select,textarea):focus-visible{
  outline: 2px solid var(--focus);
  outline-offset: 2px;
  border-radius: 8px;
}

/* utilities */
.container{ inline-size: var(--container-w); margin-inline: auto; }
.fullbleed{ inline-size: 100vw; margin-left: calc(50% - 50vw); margin-right: calc(50% - 50vw); }
.row{ display:flex; align-items:center; gap:.5rem; }
.row.between{ justify-content: space-between; }

/* ========== 1) Panels (공통 카드) ========== */
.panel{
  background: var(--panel);
  border: 1px solid var(--line);
  border-radius: var(--radius);
  padding: 16px;
  box-shadow: var(--shadow);
}
.panel .panel-head{ display:flex; justify-content:space-between; align-items:center; gap:8px; margin-bottom: 10px; }
.panel h3{ font-size: 16px; font-weight: 800; }

/* ========== 2) Header/Nav (선택적) ========== */
header.nav{
  position: sticky; top: 0; z-index: 50;
  height: var(--nav-h); background: var(--bg);
  display:flex; align-items:center;
  border-bottom: 1px solid var(--line);
}
.nav-inner{ inline-size: var(--container-w); margin: 0 auto; padding: 0 20px; display:flex; align-items:center; justify-content:space-between; }
.menu{ list-style:none; display:flex; gap:18px; }
.menu a{ text-decoration:none; color:#333; font-weight:600; opacity:.9; }
.menu a:hover{ opacity:1; }

/* ========== 3) Profile hero ========== */
.adminme{ inline-size: var(--container-w); margin: 18px auto 28px; }
.profile-hero{
  display:flex; align-items:center; justify-content:space-between; gap: 16px;
  padding: 18px; border-radius: 22px;
  background: linear-gradient(180deg, #A9B9CF, #A9B9CF);
  color: #0d3800; /* 제목계 컬러는 어두운 녹색 톤 */
}
.ph-left{ display:flex; align-items:center; gap: 14px; min-width: 0; }
.name-block{ min-width: 0; }
.display-name{ font-size: 28px; line-height: 1.1; font-weight: 800; letter-spacing: -.2px; color:#0d3800; }
.email{ margin-top: 4px; font-size: 14px; color:#0d3800; opacity:.85; font-weight: 700; }
.badge-line{ margin-top: 6px; }
.grade-badge{
  display:inline-block; padding:6px 10px; border-radius: 9999px;
  background: #fff; color:#111; border: 1px solid var(--line); font-weight: 800; font-size: 12px;
}

.ph-right{ display:flex; gap:8px; flex:0 0 auto; }

/* avatar */
.avatar{
  inline-size: 88px; block-size: 88px; border-radius: 22px;
  display:grid; place-items:center; font-weight:800;
  background: hsl(var(--h) 75% 86%); color: hsl(var(--h) 60% 28%);
  position:relative; overflow:hidden; user-select:none; box-shadow: var(--shadow);
}
.avatar::after{ content: attr(data-initials); font-size: 30px; letter-spacing:.5px; }
#me-avatar.avatar{ border-radius: 50%; }
#me-avatar.avatar .avatar-img{ display:none; width:100%; height:100%; object-fit: cover; }
#me-avatar.avatar.url-mode .avatar-img{ display:block; }
#me-avatar.avatar.url-mode::after{ content:""; }
.avatar.h0{--h:0}.avatar.h1{--h:15}.avatar.h2{--h:30}.avatar.h3{--h:45}.avatar.h4{--h:60}.avatar.h5{--h:75}
.avatar.h6{--h:90}.avatar.h7{--h:105}.avatar.h8{--h:120}.avatar.h9{--h:135}.avatar.h10{--h:150}.avatar.h11{--h:165}
.avatar.h12{--h:180}.avatar.h13{--h:195}.avatar.h14{--h:210}.avatar.h15{--h:225}.avatar.h16{--h:240}.avatar.h17{--h:255}
.avatar.h18{--h:270}.avatar.h19{--h:285}.avatar.h20{--h:300}.avatar.h21{--h:315}.avatar.h22{--h:330}.avatar.h23{--h:345}

/* ========== 4) Buttons ========== */
.btn{
  appearance:none; border:1px solid var(--line);
  background:#fff; color:#111; font-weight:800;
  padding: 10px 16px; border-radius: 9999px; cursor:pointer;
  transition: transform .15s ease, box-shadow .15s ease, filter .15s ease, opacity .15s ease;
}
.btn:hover{ transform: translateY(-1px); box-shadow: var(--shadow); }
.btn[aria-busy="true"]{ opacity:.7; pointer-events:none; }
.btn.primary, .btn-primary{ background: var(--accent); border-color: transparent; color:#111; }
.btn.primary:hover, .btn-primary:hover{ filter: brightness(.98); }
.btn.ghost{ background:#fff; color:#111; }

.btn-logout{
  display:inline-flex; align-items:center; justify-content:center; gap:0;
  min-width: 160px; padding: 12px 20px; font-weight:700;
  border:1px solid var(--line); border-radius:9999px; background:#e9e9ec;
}
.btn-logout:hover{ background:#dedee2; }
.btn-logout[aria-busy="true"]{ background: var(--accent); color:#111; }

.btn-delete{
  inline-size: 48px; block-size: 48px; aspect-ratio: 1 / 1; border-radius: 50%;
  display:grid; place-items:center; background:#e9e9ec; border:1px solid var(--line);
}
.btn-delete::before{
  content:""; inline-size:22px; block-size:22px; background: currentColor;
  -webkit-mask: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none'><path d='M18 8L22 12M22 12L18 16M22 12H9M15 4.20404C13.7252 3.43827 12.2452 3 10.6667 3C5.8802 3 2 7.02944 2 12C2 16.9706 5.8802 21 10.6667 21C12.2452 21 13.7252 20.5617 15 19.796' stroke='%23000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/></svg>") center/contain no-repeat;
          mask: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none'><path d='M18 8L22 12M22 12L18 16M22 12H9M15 4.20404C13.7252 3.43827 12.2452 3 10.6667 3C5.8802 3 2 7.02944 2 12C2 16.9706 5.8802 21 10.6667 21C12.2452 21 13.7252 20.5617 15 19.796' stroke='%23000' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/></svg>") center/contain no-repeat;
}
.btn-delete:hover{ background:#dedee2; }

/* ========== 5) Insights → Leaderboards ========== */
/* adminme.js 가 section.insights 안에 #lb-root.lb-grid 를 주입 */
.insights{ inline-size: var(--container-w); margin: 0 auto 22px; }
.lb-grid{ display:grid; gap: 16px; }
@media (min-width: 960px){ .lb-grid{ grid-template-columns: 1fr 1fr; } }

.lb-grid .panel{ padding: 14px; }
.lb-grid .panel h3{ margin: 0 0 8px; font-size:16px; font-weight:800; }

.lb-grid table.lb{
  width:100%; border-collapse: collapse; table-layout: fixed;
  background:#fff; border-radius: 12px; overflow:hidden;
}
.lb-grid table.lb th, .lb-grid table.lb td{
  border-bottom: 1px solid var(--line); padding: 8px 10px; text-align: right; vertical-align: middle;
  font-size: 14px; font-variant-numeric: tabular-nums;
}
.lb-grid table.lb th:nth-child(1), .lb-grid table.lb td:nth-child(1){ text-align:left; width: 64px; }
.lb-grid table.lb th:nth-child(2), .lb-grid table.lb td:nth-child(2){ text-align:left; }

.lb-grid .acc{ display:flex; align-items:center; gap:8px; min-width:0; }
.lb-grid .acc .lb-avatar{
  width:22px; height:22px; border-radius:50%; object-fit:cover; display:block; flex:0 0 auto; background:#e9e9ec;
}
.lb-grid .acc > div{ min-width:0; }
.lb-grid .acc > div > div{ overflow:hidden; white-space:nowrap; text-overflow:ellipsis; }
.lb-grid .muted{ opacity:.65; font-size:12px; }
.lb-grid .err{ color:#ff7b7b; }

/* ========== 6) Quick panels & collection summary ========== */
.quick{
  inline-size: var(--container-w);
  margin: 18px auto 0;
  display:grid; gap: 16px;
  grid-template-columns: 1fr 1fr;
}
@media (max-width: 860px){ .quick{ grid-template-columns: 1fr; } }

.grid-3{ display:grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
.kpi{ display:flex; flex-direction:column; align-items:flex-start; gap:6px; }
.kpi b{ font-size:22px; line-height:1; }
.kpi span{ font-size:12px; color:#777; }

/* 첫 패널(Collection)을 세로 정렬 */
.quick .panel:first-child{ display:grid; }
.quick .panel:first-child .grid-3{ align-content:center; justify-items:flex-start; }

/* ========== 7) Lab (aud laboratory) ========== */
.lab-wrap{
  inline-size: var(--container-w); margin: 18px auto 0;
  display:grid; gap:16px; grid-template-columns: 1fr min(640px, 55%);
}
@media (max-width: 1000px){ .lab-wrap{ grid-template-columns: 1fr; } }

.panel.lab{
  display:grid; grid-template-rows: auto 1fr auto; gap: 10px; min-height: 420px;
}
.lab-head{ display:flex; align-items:baseline; justify-content:space-between; gap:10px; }
.lab-head h3{ font-size:16px; font-weight:800; }
.lab-stats{ color: var(--muted); font-size: 12px; }
.lab-canvas-wrap{
  position:relative; border-radius: 16px; background:#fff; box-shadow: inset 0 0 0 1px var(--line);
  overflow:hidden; height: clamp(300px, 42vh, 520px);
}
#aud-canvas{
  display:block; width:100%; height:100%; touch-action:none;
  background: linear-gradient(180deg, #f8fafc, #eef2f7 50%, #e6ebf3);
}
.lab-controls{ display:flex; align-items:center; gap:8px; }
.lab-controls .spacer{ flex:1; }
#aud-canvas:focus-visible{ outline: 3px solid var(--focus); outline-offset: 2px; }

/* ========== 8) Modals (edit / avatar / admin-lab) ========== */
.modal{
  position:fixed; inset:0; display:grid; place-items:center; padding: 20px;
  background: rgba(0,0,0,.0); pointer-events:none; opacity:0;
  transition: opacity .18s ease, background .18s ease;
}
.modal.open{ background: rgba(0,0,0,.36); pointer-events:auto; opacity:1; }
.modal .sheet{
  inline-size: min(560px, 92vw); background:#fff; border-radius: 20px;
  box-shadow: 0 20px 60px rgba(0,0,0,.22);
  padding: 18px; transform: translateY(8px); opacity:.98;
  transition: transform .18s ease, opacity .18s ease;
}
.modal.open .sheet{ transform: translateY(0); opacity: 1; }
.modal .overlay{ position:fixed; inset:0; background: transparent; border:0; }
.modal .title{ font-size: 20px; font-weight: 800; margin: 2px 4px 14px; }

.form-row{ display:grid; gap:6px; margin:10px 4px; }
.form-row > label{ font-size: 13px; font-weight: 800; color:#222; }
.form-row > input{
  appearance:none; background:#fff; border:1px solid var(--line);
  border-radius: 12px; padding: 12px 14px; font-size: 14px;
}
.fieldset{
  border:1px solid var(--line); border-radius: 14px; padding: 8px 10px 12px; margin: 12px 4px 8px;
}
.fieldset > legend{ padding:0 6px; font-size:12px; font-weight:800; color:#333; }
.actions{ display:flex; gap:8px; justify-content:flex-end; align-items:center; margin: 14px 4px 0; }
.msg{ font-size: 13px; color: var(--accent); margin: 10px 4px 0; min-height: 1.2em; }

/* Avatar modal specific */
#avatar-modal .sheet{ inline-size: min(640px, 96vw); }
#avatar-modal .cropper{ display:grid; place-items:center; margin:14px 0 10px; }
#avatar-modal #av-canvas{ display:block; margin-inline:auto; max-inline-size:100%; aspect-ratio:1 / 1; }

/* Admin Lab modal */
#admin-lab.modal{ z-index: 1000; }
#admin-lab .sheet{ inline-size: min(980px, 92vw); }
#admin-lab .overlay{ position:fixed; inset:0; }
#admin-lab .admin-toolbar{ display:flex; align-items:center; gap:8px; margin:8px 0 14px; }
#admin-lab .admin-toolbar .spacer{ flex:1; }
#admin-lab .admin-grid{ display:grid; grid-template-columns: repeat(auto-fill, minmax(180px,1fr)); gap:12px; }
#admin-lab .empty{ color:#9ca3af; padding:24px; text-align:center; border:1px dashed #e5e7eb; border-radius:12px; }
#admin-lab .card{
  background:#fff; border:1px solid var(--line); border-radius:12px; padding:12px 14px 14px;
  display:grid; row-gap:10px;
}
#admin-lab .card img{ width:100%; height:auto; border-radius:12px; display:block; background:#f3f4f6; }
#admin-lab .card .meta{ display:flex; align-items:center; justify-content:space-between; gap:10px; margin:6px 0 2px; line-height:1.3; font-size:12px; color:#6b7280; }
#admin-lab .card .meta .owner, #admin-lab .card .meta .ns, #admin-lab .card .meta .time{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
#admin-lab .row--spaced{ display:flex; align-items:center; gap:12px; margin-top:10px; min-height:44px; }
#admin-lab .row--spaced .btn{ padding:10px 16px; }

/* ========== 9) Footer ========== */
.mine-footer{
  inline-size: var(--container-w); margin: 48px auto 64px;
  padding-top: 24px; border-top: 1px solid var(--line); background: transparent;
}
.mine-footer .footer-inner{
  display:flex; justify-content:center; gap:12px;
}
.mine-footer .btn-logout{ min-width:auto; padding-inline:18px; white-space:nowrap; }

/* ========== 10) Responsive tweaks ========== */
@media (max-width: 860px){
  .profile-hero{ flex-direction: column; align-items: flex-start; }
  .ph-right{ align-self: stretch; }
  .quick{ grid-template-columns: 1fr; }
}
